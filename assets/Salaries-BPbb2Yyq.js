"use strict";import{Ct as d,Dt as R,Et as Q,K as X,Tt as s,W as I,_ as Y,_t as T,a as Z,at as aa,c as B,ct as E,d as v,f as ea,ft as t,g as la,gt as H,h as sa,l as L,lt as O,m as f,mt as ta,o as oa,ot as i,p as W,s as ia,st as j,u as na,ut as ra,wt as S,xt as ca,yt as ua}from"./vendor-C-3YS4ol.js";import{t as da}from"./_plugin-vue_export-helper-BwBpWJRZ.js";var pa={class:"salary-calculator"},ma={class:"main-content"},va={class:"upload-section"},ba={key:0,class:"upload-overlay"},ha={class:"tarifas-config"},fa={class:"tarifa-item"},ya={class:"tarifa-item"},ga={class:"tarifa-item"},$a={class:"actions"},Va={key:1,class:"total-display"},Ia={class:"total-value"},Ta={class:"table-header"},Sa={class:"detail-text"},_a={key:1,class:"empty-state"},G="tarifas_salarios",P="empleados_labels",xa=da(ta({__name:"Salaries",setup(Na){let n=S({tarifaInteres:1100,tarifaNoInteres:1100,tarifaDepto:2500});function J(){try{let c=localStorage.getItem(G);return c?JSON.parse(c):{tarifaInteres:1100,tarifaNoInteres:1100,tarifaDepto:2500}}catch{return{tarifaInteres:1100,tarifaNoInteres:1100,tarifaDepto:2500}}}function w(c){localStorage.setItem(G,JSON.stringify(c))}H(()=>{n.value=J(),document.body.classList.add("dark-theme")});let r=S([]),{copy:z}=Z(),y=X(),_=S(!1),N=S(0),D=S(!1),x=S(!1);function A(){try{return JSON.parse(localStorage.getItem(P)||"{}")}catch{return{}}}function C(c){localStorage.setItem(P,JSON.stringify(c))}let U=aa(()=>r.value.reduce((c,l)=>c+(l.salario||0),0));async function F(c){let l=c.files[0];if(l){x.value=!0;try{let u=la(await l.arrayBuffer(),{type:"array"}),a=u.Sheets[u.SheetNames[0]],o=Y.sheet_to_json(a,{defval:""}),g=A();r.value=o.map(p=>{let $=p.Nombre||p.nombre||"Desconocido",V=p["ID de Usuario"]||p.id||"",e=String(p["Tiempo Total (min)"]??p.minutos??"").trim(),m=0;m=e.endsWith("h")?parseFloat(e.replace("h","").replace(",","."))*60:parseFloat(e.replace(",","."));let h=Math.round(m/60);return{id:String(V),nombre:String($),minutos:isNaN(m)?0:m,horas:isNaN(h)?0:h,psicotecnicos:0,instrucciones:0,visitas:0,cirugias:0,inspecciones:0,interes:"No",salario:0,detalle:"",label:g[V]||""}}),y.success("Archivo cargado correctamente",{position:I.BOTTOM_RIGHT})}catch{y.error("Error al procesar el archivo",{position:I.BOTTOM_RIGHT})}finally{x.value=!1}}}async function K(){if(r.value.length===0){y.warning("No hay empleados cargados",{position:I.BOTTOM_RIGHT});return}_.value=!0,D.value=!0,N.value=0;let c=n.value.tarifaDepto,l=r.value.length;for(let u=0;u<l;u++){await new Promise(e=>setTimeout(e,50));let a=r.value[u],o=a.interes==="S\xED"?n.value.tarifaInteres:n.value.tarifaNoInteres,g=a.horas*o,p=a.psicotecnicos+a.instrucciones+a.visitas+a.cirugias+a.inspecciones,$=g+p*n.value.tarifaDepto,V=`\u{1F4B8}${a.label&&a.label.trim()!==""?a.label:a.nombre} (${a.horas}h): ${a.horas} * ${o} + ${c} * ${p} = $${$}`;r.value[u]={...a,salario:$,detalle:V},N.value=Math.round((u+1)/l*100)}C(Object.fromEntries(r.value.map(u=>[u.id,u.label]))),N.value=100,_.value=!1,setTimeout(()=>{D.value=!1},800),y.success(`Salarios calculados para ${l} empleados`,{position:I.BOTTOM_RIGHT})}async function q(){if(r.value.length===0){y.warning("No hay nada para copiar",{position:I.BOTTOM_RIGHT});return}let c=n.value.tarifaDepto,l=e=>Math.round(e).toString();function u(e){let m=e.psicotecnicos+e.instrucciones+e.visitas+e.cirugias+e.inspecciones;return e.horas>0||m>0?`${e.horas}h`:"Ausencia"}let a=r.value.map(e=>`\u{1F550} ${e.label&&e.label.trim()!==""?e.label:e.nombre} - ${u(e)}`).join(`
`);function o(e,m){let h=r.value.filter(b=>b[m]>0).map(b=>`${b.label&&b.label.trim()!==""?b.label:b.nombre} - ${b[m]}`).join(`
`);return h?`
**${e}:**
${h}`:""}let g=[o("Psicot\xE9cnicos","psicotecnicos"),o("Instrucciones","instrucciones"),o("Visitas Psicol\xF3gicas","visitas"),o("Cirug\xEDas Est\xE9ticas","cirugias"),o("Inspecciones","inspecciones")].filter(Boolean),p=g.length>0?g.join(`
`):"",$=r.value.map(e=>{let m=e.label&&e.label.trim()!==""?e.label:e.nombre,h=e.interes==="S\xED"?n.value.tarifaInteres:n.value.tarifaNoInteres,b=e.horas*h,k=e.psicotecnicos+e.instrucciones+e.visitas+e.cirugias+e.inspecciones,M=b+k*n.value.tarifaDepto;return k>0?`\u{1F4B8}  ${m} - ${e.horas}h x ${l(h)}$ = ${l(b)}$ + (${k}x ${l(c)}$) = **${l(M)}$**`:`\u{1F4B8}  ${m} - ${e.horas}h x ${l(h)}$ = **${l(M)}$**`}).join(`
`),V=`${l(U.value)}$`;await z(a+(p?`
${p}`:"")+`

${$}

TOTAL: ${V}`),y.info("Resultados copiados al portapapeles",{position:I.BOTTOM_RIGHT})}return ca(r,c=>{C(Object.fromEntries(c.map(l=>[l.id,l.label])))},{deep:!0}),H(()=>{document.body.classList.add("dark-theme")}),(c,l)=>{let u=ua("Toast");return T(),O("div",pa,[t(u),l[14]||=ra('<div class="header" data-v-45bf34c2><div class="header-content" data-v-45bf34c2><h1 class="title" data-v-45bf34c2><span class="icon" data-v-45bf34c2>\u{1F4B0}</span> Gesti\xF3n de Salarios </h1><p class="subtitle" data-v-45bf34c2>Sistema de c\xE1lculo de n\xF3mina avanzado</p></div></div>',1),i("div",ma,[t(s(L),{class:"control-panel"},{content:d(()=>[i("div",va,[i("div",{class:Q(["upload-area",{uploading:x.value}])},[t(s(oa),{mode:"basic",accept:".xlsx,.xls",customUpload:"",auto:!0,chooseLabel:"\u{1F4CA} Subir Excel",class:"custom-upload",onUploader:F,disabled:x.value},null,8,["disabled"]),x.value?(T(),O("div",ba,[...l[6]||=[i("i",{class:"pi pi-spin pi-spinner"},null,-1),i("span",null,"Procesando archivo...",-1)]])):E("",!0)],2)]),i("div",ha,[l[10]||=i("h3",null,"Configuraci\xF3n de Tarifas",-1),i("div",fa,[l[7]||=i("label",null,"Tarifa con Inter\xE9s ($):",-1),t(s(f),{modelValue:n.value.tarifaInteres,"onUpdate:modelValue":[l[0]||=a=>n.value.tarifaInteres=a,l[1]||=a=>w(n.value)],min:0,class:"custom-number"},null,8,["modelValue"])]),i("div",ya,[l[8]||=i("label",null,"Tarifa sin Inter\xE9s ($):",-1),t(s(f),{modelValue:n.value.tarifaNoInteres,"onUpdate:modelValue":[l[2]||=a=>n.value.tarifaNoInteres=a,l[3]||=a=>w(n.value)],min:0,class:"custom-number"},null,8,["modelValue"])]),i("div",ga,[l[9]||=i("label",null,"Tarifa por Departamento ($):",-1),t(s(f),{modelValue:n.value.tarifaDepto,"onUpdate:modelValue":[l[4]||=a=>n.value.tarifaDepto=a,l[5]||=a=>w(n.value)],min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue"])])]),i("div",$a,[t(s(W),{label:_.value?"Calculando...":"Calcular Salarios",icon:"pi pi-calculator",class:"calculate-btn",loading:_.value,disabled:r.value.length===0||_.value,onClick:K},null,8,["label","loading","disabled"]),t(s(W),{label:"Copiar Resultados",icon:"pi pi-copy",severity:"secondary",class:"copy-btn",disabled:U.value===0,onClick:q},null,8,["disabled"])]),D.value?(T(),j(s(ia),{key:0,value:N.value,class:"progress-bar smooth-progress"},null,8,["value"])):E("",!0),U.value>0?(T(),O("div",Va,[l[11]||=i("span",{class:"total-label"},"Total n\xF3mina",-1),i("span",Ia,"$ "+R(U.value.toLocaleString()),1)])):E("",!0)]),_:1}),r.value.length>0?(T(),j(s(L),{key:0,class:"employees-table"},{title:d(()=>[i("div",Ta,[l[12]||=i("span",null,"Empleados",-1),t(s(B),{value:`${r.value.length} empleados`,class:"employee-count"},null,8,["value"])])]),content:d(()=>[t(s(ea),{value:r.value,dataKey:"id",responsiveLayout:"scroll",stripedRows:"",class:"custom-table",paginator:r.value.length>8,rows:8,scrollable:"",scrollHeight:"600px"},{default:d(()=>[t(s(v),{field:"id",header:"ID",class:"id-column",style:{minWidth:"80px"}}),t(s(v),{field:"nombre",header:"Nombre",class:"name-column",style:{minWidth:"150px"}}),t(s(v),{header:"Label",class:"label-column"},{body:d(({data:a})=>[t(s(sa),{modelValue:a.label,"onUpdate:modelValue":o=>a.label=o,placeholder:"Etiqueta personalizada",class:"custom-input",style:{minWidth:"120px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{field:"horas",header:"Horas",sortable:"",class:"hours-column",style:{minWidth:"80px"}}),t(s(v),{header:"Psicot\xE9cnicos",class:"dept-column"},{body:d(({data:a})=>[t(s(f),{modelValue:a.psicotecnicos,"onUpdate:modelValue":o=>a.psicotecnicos=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{header:"Instrucciones",class:"dept-column"},{body:d(({data:a})=>[t(s(f),{modelValue:a.instrucciones,"onUpdate:modelValue":o=>a.instrucciones=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{header:"Visitas Psicol\xF3gicas",class:"dept-column"},{body:d(({data:a})=>[t(s(f),{modelValue:a.visitas,"onUpdate:modelValue":o=>a.visitas=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{header:"Cirug\xEDas Est\xE9ticas",class:"dept-column"},{body:d(({data:a})=>[t(s(f),{modelValue:a.cirugias,"onUpdate:modelValue":o=>a.cirugias=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{header:"Inspecciones",class:"dept-column"},{body:d(({data:a})=>[t(s(f),{modelValue:a.inspecciones,"onUpdate:modelValue":o=>a.inspecciones=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{header:"Inter\xE9s",class:"interest-column"},{body:d(({data:a})=>[t(s(na),{modelValue:a.interes,"onUpdate:modelValue":o=>a.interes=o,options:["S\xED","No"],placeholder:"Seleccionar",class:"custom-dropdown"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(s(v),{header:"Detalle",class:"detail-column",style:{minWidth:"200px"}},{body:d(({data:a})=>[i("span",Sa,R(a.detalle),1)]),_:1}),t(s(v),{header:"Salario",class:"salary-column",style:{minWidth:"120px"}},{body:d(({data:a})=>[t(s(B),{value:`$ ${a.salario.toLocaleString()}`,severity:a.salario>5e4?"success":a.salario>2e4?"info":"warning",class:"salary-tag"},null,8,["value","severity"])]),_:1})]),_:1},8,["value","paginator"])]),_:1})):(T(),O("div",_a,[...l[13]||=[i("div",{class:"empty-content"},[i("i",{class:"pi pi-file-excel empty-icon"}),i("h3",null,"No hay datos cargados"),i("p",null,"Sube un archivo Excel para comenzar a gestionar los salarios")],-1)]]))])])}}}),[["__scopeId","data-v-45bf34c2"]]);export{xa as default};
