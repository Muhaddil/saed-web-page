"use strict";import{a as aa,u as U,a5 as ea,a6 as sa,c as la,a0 as oa,a3 as ia,a7 as ta,f as M,o as S,g as l,a8 as na,y as c,e as G,w as r,V as j,a2 as ca,a9 as s,aa as ra,ab as L,ac as da,M as W,ad as P,ae as ua,af as p,ag as pa,ah as w,ai as ma,aj as D,ak as va,al as ha,n as x}from"./vendor-ZH5xudbx.js";import{_ as ba}from"./main-BvwxNRIE.js";const ya={class:"salary-calculator"},ga={class:"main-content"},$a={class:"upload-section"},fa={key:0,class:"upload-overlay"},Va={class:"actions"},Ta={key:1,class:"total-display"},_a={class:"total-value"},Sa={class:"table-header"},xa={class:"detail-text"},Oa={key:1,class:"empty-state"},z="empleados_labels",Ia=aa({__name:"Salaries",setup(wa){const n=U([]),{copy:A}=ea(),V=sa(),O=U(!1),N=U(0),E=U(!1),I=U(!1);function F(){try{return JSON.parse(localStorage.getItem(z)||"{}")}catch{return{}}}function B(d){localStorage.setItem(z,JSON.stringify(d))}const k=la(()=>n.value.reduce((d,i)=>d+(i.salario||0),0));async function J(d){const i=d.files[0];if(i){I.value=!0;try{const u=await i.arrayBuffer(),a=va(u,{type:"array"}),o=a.Sheets[a.SheetNames[0]],t=ha.sheet_to_json(o,{defval:""}),m=F();n.value=t.map(v=>{const T=v.Nombre||v.nombre||"Desconocido",_=v["ID de Usuario"]||v.id||"",g=String(v["Tiempo Total (min)"]??v.minutos??"").trim();let b=0;g.endsWith("h")?b=parseFloat(g.replace("h","").replace(",","."))*60:b=parseFloat(g.replace(",","."));const f=Math.round(b/60);return{id:String(_),nombre:String(T),minutos:isNaN(b)?0:b,horas:isNaN(f)?0:f,psicotecnicos:0,instrucciones:0,visitas:0,cirugias:0,inspecciones:0,interes:"No",salario:0,detalle:"",label:m[_]||""}}),V.success("Archivo cargado correctamente",{position:x.BOTTOM_RIGHT})}catch{V.error("Error al procesar el archivo",{position:x.BOTTOM_RIGHT})}finally{I.value=!1}}}async function q(){if(n.value.length===0){V.warning("No hay empleados cargados",{position:x.BOTTOM_RIGHT});return}O.value=!0,E.value=!0,N.value=0;const d=1300,i=900,u=2500,a=n.value.length;for(let o=0;o<a;o++){await new Promise(f=>setTimeout(f,50));const t=n.value[o],m=t.interes==="S\xED"?d:i,v=t.horas*m,T=t.psicotecnicos+t.instrucciones+t.visitas+t.cirugias+t.inspecciones,_=T*u,g=v+_,b=`\u{1F4B8}${t.label&&t.label.trim()!==""?t.label:t.nombre} (${t.horas}h): ${t.horas} * ${m} + ${u} * ${T} = $${g}`;n.value[o]={...t,salario:g,detalle:b},N.value=Math.round((o+1)/a*100)}B(Object.fromEntries(n.value.map(o=>[o.id,o.label]))),N.value=100,O.value=!1,setTimeout(()=>{E.value=!1},800),V.success(`Salarios calculados para ${a} empleados`,{position:x.BOTTOM_RIGHT})}async function K(){if(n.value.length===0){V.warning("No hay nada para copiar",{position:x.BOTTOM_RIGHT});return}const d=1300,i=900,u=2500,a=e=>Math.round(e).toString();function o(e){const y=e.psicotecnicos+e.instrucciones+e.visitas+e.cirugias+e.inspecciones;return e.horas>0?`${e.horas}h`:y>0?`${e.horas}h`:"Ausencia"}const t=n.value.map(e=>{const y=e.label&&e.label.trim()!==""?e.label:e.nombre,$=o(e);return`\u{1F550} ${y} - ${$}`}).join(`
`);function m(e,y){const $=n.value.filter(h=>h[y]>0).map(h=>`${h.label&&h.label.trim()!==""?h.label:h.nombre} - ${h[y]}`).join(`
`);return $?`
**${e}:**
${$}`:""}const v=m("Psicot\xE9cnicos","psicotecnicos"),T=m("Instrucciones","instrucciones"),_=m("Visitas Psicol\xF3gicas","visitas"),g=m("Cirug\xEDas Est\xE9ticas","cirugias"),b=m("Inspecciones","inspecciones"),f=[v,T,_,g,b].filter(Boolean),H=f.length>0?f.join(`
`):"",Q=n.value.map(e=>{const y=e.label&&e.label.trim()!==""?e.label:e.nombre,$=e.interes==="S\xED"?d:i,h=e.horas*$,R=e.psicotecnicos+e.instrucciones+e.visitas+e.cirugias+e.inspecciones,Z=R*u,C=h+Z;return R>0?`\u{1F4B8}  ${y} - ${e.horas}h x ${a($)}$ = ${a(h)}$ + (${R}x ${a(u)}$) = **${a(C)}$**`:`\u{1F4B8}  ${y} - ${e.horas}h x ${a($)}$ = **${a(C)}$**`}).join(`
`),X=`${a(k.value)}$`,Y=t+(H?`
${H}`:"")+`

${Q}

TOTAL: ${X}`;await A(Y),V.info("Resultados copiados al portapapeles",{position:x.BOTTOM_RIGHT})}return oa(n,d=>{const i=Object.fromEntries(d.map(u=>[u.id,u.label]));B(i)},{deep:!0}),ia(()=>{document.body.classList.add("dark-theme")}),(d,i)=>{const u=ta("Toast");return S(),M("div",ya,[l(u),i[4]||(i[4]=na('<div class="header" data-v-84c3d03e><div class="header-content" data-v-84c3d03e><h1 class="title" data-v-84c3d03e><span class="icon" data-v-84c3d03e>\u{1F4B0}</span> Gesti\xF3n de Salarios </h1><p class="subtitle" data-v-84c3d03e>Sistema de c\xE1lculo de n\xF3mina avanzado</p></div></div>',1)),c("div",ga,[l(s(P),{class:"control-panel"},{content:r(()=>[c("div",$a,[c("div",{class:ca(["upload-area",{uploading:I.value}])},[l(s(ra),{mode:"basic",accept:".xlsx,.xls",customUpload:"",auto:!0,chooseLabel:"\u{1F4CA} Subir Excel",class:"custom-upload",onUploader:J,disabled:I.value},null,8,["disabled"]),I.value?(S(),M("div",fa,[...i[0]||(i[0]=[c("i",{class:"pi pi-spin pi-spinner"},null,-1),c("span",null,"Procesando archivo...",-1)])])):j("",!0)],2)]),c("div",Va,[l(s(L),{label:O.value?"Calculando...":"Calcular Salarios",icon:"pi pi-calculator",class:"calculate-btn",loading:O.value,disabled:n.value.length===0||O.value,onClick:q},null,8,["label","loading","disabled"]),l(s(L),{label:"Copiar Resultados",icon:"pi pi-copy",severity:"secondary",class:"copy-btn",disabled:k.value===0,onClick:K},null,8,["disabled"])]),E.value?(S(),G(s(da),{key:0,value:N.value,class:"progress-bar smooth-progress"},null,8,["value"])):j("",!0),k.value>0?(S(),M("div",Ta,[i[1]||(i[1]=c("span",{class:"total-label"},"Total n\xF3mina",-1)),c("span",_a,"$ "+W(k.value.toLocaleString()),1)])):j("",!0)]),_:1}),n.value.length>0?(S(),G(s(P),{key:0,class:"employees-table"},{title:r(()=>[c("div",Sa,[i[2]||(i[2]=c("span",null,"Empleados",-1)),l(s(D),{value:`${n.value.length} empleados`,class:"employee-count"},null,8,["value"])])]),content:r(()=>[l(s(ua),{value:n.value,dataKey:"id",responsiveLayout:"scroll",stripedRows:"",class:"custom-table",paginator:n.value.length>10,rows:10,scrollable:"",scrollHeight:"600px"},{default:r(()=>[l(s(p),{field:"id",header:"ID",class:"id-column",style:{minWidth:"80px"}}),l(s(p),{field:"nombre",header:"Nombre",class:"name-column",style:{minWidth:"150px"}}),l(s(p),{header:"Label",class:"label-column"},{body:r(({data:a})=>[l(s(pa),{modelValue:a.label,"onUpdate:modelValue":o=>a.label=o,placeholder:"Etiqueta personalizada",class:"custom-input",style:{minWidth:"120px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{field:"horas",header:"Horas",sortable:"",class:"hours-column",style:{minWidth:"80px"}}),l(s(p),{header:"Psicot\xE9cnicos",class:"dept-column"},{body:r(({data:a})=>[l(s(w),{modelValue:a.psicotecnicos,"onUpdate:modelValue":o=>a.psicotecnicos=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{header:"Instrucciones",class:"dept-column"},{body:r(({data:a})=>[l(s(w),{modelValue:a.instrucciones,"onUpdate:modelValue":o=>a.instrucciones=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{header:"Visitas Psicol\xF3gicas",class:"dept-column"},{body:r(({data:a})=>[l(s(w),{modelValue:a.visitas,"onUpdate:modelValue":o=>a.visitas=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{header:"Cirug\xEDas Est\xE9ticas",class:"dept-column"},{body:r(({data:a})=>[l(s(w),{modelValue:a.cirugias,"onUpdate:modelValue":o=>a.cirugias=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{header:"Inspecciones",class:"dept-column"},{body:r(({data:a})=>[l(s(w),{modelValue:a.inspecciones,"onUpdate:modelValue":o=>a.inspecciones=o,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{header:"Inter\xE9s",class:"interest-column"},{body:r(({data:a})=>[l(s(ma),{modelValue:a.interes,"onUpdate:modelValue":o=>a.interes=o,options:["S\xED","No"],placeholder:"Seleccionar",class:"custom-dropdown"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(s(p),{header:"Detalle",class:"detail-column",style:{minWidth:"200px"}},{body:r(({data:a})=>[c("span",xa,W(a.detalle),1)]),_:1}),l(s(p),{header:"Salario",class:"salary-column",style:{minWidth:"120px"}},{body:r(({data:a})=>[l(s(D),{value:`$ ${a.salario.toLocaleString()}`,severity:a.salario>5e4?"success":a.salario>2e4?"info":"warning",class:"salary-tag"},null,8,["value","severity"])]),_:1})]),_:1},8,["value","paginator"])]),_:1})):(S(),M("div",Oa,[...i[3]||(i[3]=[c("div",{class:"empty-content"},[c("i",{class:"pi pi-file-excel empty-icon"}),c("h3",null,"No hay datos cargados"),c("p",null,"Sube un archivo Excel para comenzar a gestionar los salarios")],-1)])]))])])}}}),Ua=ba(Ia,[["__scopeId","data-v-84c3d03e"]]);export{Ua as default};
