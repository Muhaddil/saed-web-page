"use strict";import{Ct as d,Dt as W,Et as A,K as F,Tt as l,W as f,_ as J,_t as V,a as K,at as q,c as k,ct as E,d as m,f as Q,ft as s,g as X,gt as Y,h as Z,l as B,lt as w,m as x,mt as aa,o as ea,ot as c,p as C,s as la,st as H,u as sa,ut as oa,wt as S,xt as ta,yt as ia}from"./vendor-C4aXRbp1.js";import{t as na}from"./_plugin-vue_export-helper-BwBpWJRZ.js";var ca={class:"salary-calculator"},ra={class:"main-content"},da={class:"upload-section"},ua={key:0,class:"upload-overlay"},pa={class:"actions"},ma={key:1,class:"total-display"},va={class:"total-value"},ha={class:"table-header"},ba={class:"detail-text"},ya={key:1,class:"empty-state"},j="empleados_labels",ga=na(aa({__name:"Salaries",setup($a){let i=S([]),{copy:G}=K(),b=F(),T=S(!1),O=S(0),I=S(!1),_=S(!1);function L(){try{return JSON.parse(localStorage.getItem(j)||"{}")}catch{return{}}}function M(r){localStorage.setItem(j,JSON.stringify(r))}let U=q(()=>i.value.reduce((r,o)=>r+(o.salario||0),0));async function P(r){let o=r.files[0];if(o){_.value=!0;try{let n=X(await o.arrayBuffer(),{type:"array"}),a=n.Sheets[n.SheetNames[0]],t=J.sheet_to_json(a,{defval:""}),y=L();i.value=t.map(u=>{let g=u.Nombre||u.nombre||"Desconocido",$=u["ID de Usuario"]||u.id||"",e=String(u["Tiempo Total (min)"]??u.minutos??"").trim(),p=0;p=e.endsWith("h")?parseFloat(e.replace("h","").replace(",","."))*60:parseFloat(e.replace(",","."));let h=Math.round(p/60);return{id:String($),nombre:String(g),minutos:isNaN(p)?0:p,horas:isNaN(h)?0:h,psicotecnicos:0,instrucciones:0,visitas:0,cirugias:0,inspecciones:0,interes:"No",salario:0,detalle:"",label:y[$]||""}}),b.success("Archivo cargado correctamente",{position:f.BOTTOM_RIGHT})}catch{b.error("Error al procesar el archivo",{position:f.BOTTOM_RIGHT})}finally{_.value=!1}}}async function D(){if(i.value.length===0){b.warning("No hay empleados cargados",{position:f.BOTTOM_RIGHT});return}T.value=!0,I.value=!0,O.value=0;let r=2500,o=i.value.length;for(let n=0;n<o;n++){await new Promise(e=>setTimeout(e,50));let a=i.value[n],t=(a.interes,1100),y=a.horas*t,u=a.psicotecnicos+a.instrucciones+a.visitas+a.cirugias+a.inspecciones,g=y+u*r,$=`\u{1F4B8}${a.label&&a.label.trim()!==""?a.label:a.nombre} (${a.horas}h): ${a.horas} * ${t} + ${r} * ${u} = $${g}`;i.value[n]={...a,salario:g,detalle:$},O.value=Math.round((n+1)/o*100)}M(Object.fromEntries(i.value.map(n=>[n.id,n.label]))),O.value=100,T.value=!1,setTimeout(()=>{I.value=!1},800),b.success(`Salarios calculados para ${o} empleados`,{position:f.BOTTOM_RIGHT})}async function z(){if(i.value.length===0){b.warning("No hay nada para copiar",{position:f.BOTTOM_RIGHT});return}let r=2500,o=e=>Math.round(e).toString();function n(e){let p=e.psicotecnicos+e.instrucciones+e.visitas+e.cirugias+e.inspecciones;return e.horas>0||p>0?`${e.horas}h`:"Ausencia"}let a=i.value.map(e=>`\u{1F550} ${e.label&&e.label.trim()!==""?e.label:e.nombre} - ${n(e)}`).join(`
`);function t(e,p){let h=i.value.filter(v=>v[p]>0).map(v=>`${v.label&&v.label.trim()!==""?v.label:v.nombre} - ${v[p]}`).join(`
`);return h?`
**${e}:**
${h}`:""}let y=[t("Psicot\xE9cnicos","psicotecnicos"),t("Instrucciones","instrucciones"),t("Visitas Psicol\xF3gicas","visitas"),t("Cirug\xEDas Est\xE9ticas","cirugias"),t("Inspecciones","inspecciones")].filter(Boolean),u=y.length>0?y.join(`
`):"",g=i.value.map(e=>{let p=e.label&&e.label.trim()!==""?e.label:e.nombre,h=e.interes==="S\xED"?1300:900,v=e.horas*h,N=e.psicotecnicos+e.instrucciones+e.visitas+e.cirugias+e.inspecciones,R=v+N*r;return N>0?`\u{1F4B8}  ${p} - ${e.horas}h x ${o(h)}$ = ${o(v)}$ + (${N}x ${o(r)}$) = **${o(R)}$**`:`\u{1F4B8}  ${p} - ${e.horas}h x ${o(h)}$ = **${o(R)}$**`}).join(`
`),$=`${o(U.value)}$`;await G(a+(u?`
${u}`:"")+`

${g}

TOTAL: ${$}`),b.info("Resultados copiados al portapapeles",{position:f.BOTTOM_RIGHT})}return ta(i,r=>{M(Object.fromEntries(r.map(o=>[o.id,o.label])))},{deep:!0}),Y(()=>{document.body.classList.add("dark-theme")}),(r,o)=>{let n=ia("Toast");return V(),w("div",ca,[s(n),o[4]||=oa('<div class="header" data-v-1a4539fd><div class="header-content" data-v-1a4539fd><h1 class="title" data-v-1a4539fd><span class="icon" data-v-1a4539fd>\u{1F4B0}</span> Gesti\xF3n de Salarios </h1><p class="subtitle" data-v-1a4539fd>Sistema de c\xE1lculo de n\xF3mina avanzado</p></div></div>',1),c("div",ra,[s(l(B),{class:"control-panel"},{content:d(()=>[c("div",da,[c("div",{class:A(["upload-area",{uploading:_.value}])},[s(l(ea),{mode:"basic",accept:".xlsx,.xls",customUpload:"",auto:!0,chooseLabel:"\u{1F4CA} Subir Excel",class:"custom-upload",onUploader:P,disabled:_.value},null,8,["disabled"]),_.value?(V(),w("div",ua,[...o[0]||=[c("i",{class:"pi pi-spin pi-spinner"},null,-1),c("span",null,"Procesando archivo...",-1)]])):E("",!0)],2)]),c("div",pa,[s(l(C),{label:T.value?"Calculando...":"Calcular Salarios",icon:"pi pi-calculator",class:"calculate-btn",loading:T.value,disabled:i.value.length===0||T.value,onClick:D},null,8,["label","loading","disabled"]),s(l(C),{label:"Copiar Resultados",icon:"pi pi-copy",severity:"secondary",class:"copy-btn",disabled:U.value===0,onClick:z},null,8,["disabled"])]),I.value?(V(),H(l(la),{key:0,value:O.value,class:"progress-bar smooth-progress"},null,8,["value"])):E("",!0),U.value>0?(V(),w("div",ma,[o[1]||=c("span",{class:"total-label"},"Total n\xF3mina",-1),c("span",va,"$ "+W(U.value.toLocaleString()),1)])):E("",!0)]),_:1}),i.value.length>0?(V(),H(l(B),{key:0,class:"employees-table"},{title:d(()=>[c("div",ha,[o[2]||=c("span",null,"Empleados",-1),s(l(k),{value:`${i.value.length} empleados`,class:"employee-count"},null,8,["value"])])]),content:d(()=>[s(l(Q),{value:i.value,dataKey:"id",responsiveLayout:"scroll",stripedRows:"",class:"custom-table",paginator:i.value.length>8,rows:8,scrollable:"",scrollHeight:"600px"},{default:d(()=>[s(l(m),{field:"id",header:"ID",class:"id-column",style:{minWidth:"80px"}}),s(l(m),{field:"nombre",header:"Nombre",class:"name-column",style:{minWidth:"150px"}}),s(l(m),{header:"Label",class:"label-column"},{body:d(({data:a})=>[s(l(Z),{modelValue:a.label,"onUpdate:modelValue":t=>a.label=t,placeholder:"Etiqueta personalizada",class:"custom-input",style:{minWidth:"120px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{field:"horas",header:"Horas",sortable:"",class:"hours-column",style:{minWidth:"80px"}}),s(l(m),{header:"Psicot\xE9cnicos",class:"dept-column"},{body:d(({data:a})=>[s(l(x),{modelValue:a.psicotecnicos,"onUpdate:modelValue":t=>a.psicotecnicos=t,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{header:"Instrucciones",class:"dept-column"},{body:d(({data:a})=>[s(l(x),{modelValue:a.instrucciones,"onUpdate:modelValue":t=>a.instrucciones=t,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{header:"Visitas Psicol\xF3gicas",class:"dept-column"},{body:d(({data:a})=>[s(l(x),{modelValue:a.visitas,"onUpdate:modelValue":t=>a.visitas=t,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{header:"Cirug\xEDas Est\xE9ticas",class:"dept-column"},{body:d(({data:a})=>[s(l(x),{modelValue:a.cirugias,"onUpdate:modelValue":t=>a.cirugias=t,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{header:"Inspecciones",class:"dept-column"},{body:d(({data:a})=>[s(l(x),{modelValue:a.inspecciones,"onUpdate:modelValue":t=>a.inspecciones=t,min:0,class:"custom-number",style:{width:"70px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{header:"Inter\xE9s",class:"interest-column"},{body:d(({data:a})=>[s(l(sa),{modelValue:a.interes,"onUpdate:modelValue":t=>a.interes=t,options:["S\xED","No"],placeholder:"Seleccionar",class:"custom-dropdown"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(l(m),{header:"Detalle",class:"detail-column",style:{minWidth:"200px"}},{body:d(({data:a})=>[c("span",ba,W(a.detalle),1)]),_:1}),s(l(m),{header:"Salario",class:"salary-column",style:{minWidth:"120px"}},{body:d(({data:a})=>[s(l(k),{value:`$ ${a.salario.toLocaleString()}`,severity:a.salario>5e4?"success":a.salario>2e4?"info":"warning",class:"salary-tag"},null,8,["value","severity"])]),_:1})]),_:1},8,["value","paginator"])]),_:1})):(V(),w("div",ya,[...o[3]||=[c("div",{class:"empty-content"},[c("i",{class:"pi pi-file-excel empty-icon"}),c("h3",null,"No hay datos cargados"),c("p",null,"Sube un archivo Excel para comenzar a gestionar los salarios")],-1)]]))])])}}}),[["__scopeId","data-v-1a4539fd"]]);export{ga as default};
